graph LR
    %% Styles
    classDef front fill:#f8fafc,stroke:#6366f1,stroke-width:2px,color:#1e293b,rx:10,ry:10;
    classDef back fill:#eef2ff,stroke:#3b82f6,stroke-width:2px,color:#1e293b,rx:5,ry:5;
    classDef brain fill:#f0fdf4,stroke:#10b981,stroke-width:3px,color:#064e3b,rx:15,ry:15,stroke-dasharray: 5 5;
    classDef external fill:#fff1f2,stroke:#f43f5e,stroke-width:2px,color:#881337,rx:5,ry:5;
    classDef db fill:#f1f5f9,stroke:#64748b,stroke-width:2px,stroke-dasharray: 2 2;

    %% ZONE 1: FRONTEND (L'Utilisateur)
    subgraph UX ["ğŸ’» EXPERIENCE UTILISATEUR (Frontend)"]
        User((Vanessa)) -->|RequÃªte / Chat| App[ğŸ“± App Moneywork<br/>React Native / Web]
        App -->|Visu TrÃ©so| User
    end

    %% ZONE 2: BACKEND (L'Orchestrateur)
    subgraph API ["âš™ï¸ ORCHESTRATEUR (Backend GCP)"]
        FastAPI[ğŸš€ API Gateway<br/>FastAPI / Python]
        DB[(ğŸ—„ï¸ Base de DonnÃ©es<br/>PostgreSQL)]
    end

    %% ZONE 3: EXTERNAL (Le Carburant)
    subgraph DATA ["ğŸŒ DONNÃ‰ES SOURCES (APIs)"]
        Powens[ğŸ¦ Powens<br/>Banques]
        Penny[ğŸ§¾ Pennylane<br/>Factures]
        Defacto[ğŸ’¸ Partenaires<br/>Financement]
    end

    %% ZONE 4: THE BRAIN (L'Intelligence)
    subgraph BRAIN ["ğŸ§  LE CERVEAU (Vertex AI)"]
        direction TB
        Pred[ğŸ“ˆ MOTEUR PRÃ‰DICTIF<br/>XGBoost + LSTM<br/>Scoring & Forecast]
        GenAI[ğŸ¤– COPILOTE GÃ‰NÃ‰RATIF<br/>Gemini 1.5 Pro<br/>Conseil & Dialogue]
    end

    %% CONNECTIONS
    App <-->|HTTPS / JSON| FastAPI
    FastAPI <-->|Lecture/Ecriture| DB

    %% Ingestion
    FastAPI <-->|1. RÃ©cupÃ©ration DonnÃ©es| Powens
    FastAPI <-->|1. RÃ©cupÃ©ration Factures| Penny
    
    %% Intelligence Loop
    FastAPI -->|2. DonnÃ©es Brutes| Pred
    Pred -->|3. PrÃ©visions & Score| FastAPI
    
    FastAPI -->|4. Contexte + PrÃ©vision| GenAI
    GenAI -->|5. RÃ©ponse Naturelle| FastAPI

    %% Action
    FastAPI -->|6. Envoi Dossier| Defacto

    %% Application des styles
    class App front;
    class FastAPI back;
    class Pred,GenAI brain;
    class Powens,Penny,Defacto external;
    class DB db;
